<!DOCTYPE html>

<head>
    <!--
    	Pro Audio
    	http://www.templatemo.com/preview/templatemo_429_pro_audio
    -->
    <title>Surroundio - プロフェッショナルオーディオ処理サービス</title>
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/templatemo_style.css" rel="stylesheet" type="text/css">
    <link href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <style>
        /* Pastel button styles */
        .btn-pastel {
            padding: 22px 50px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none !important;
            display: inline-block;
            margin: 5px;
            color: #2C3333 !important;
        }

        .btn-pastel:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .btn-pastel.green {
            background-color: #C1FFD7 !important;  /* 더 밝은 파스텔 그린 */
        }
        .btn-pastel.green:hover {
            background-color: #B4EBC5 !important;
        }

        .btn-pastel.pink {
            background-color: #FFE5F1 !important;  /* 더 밝은 파스텔 핑크 */
        }
        .btn-pastel.pink:hover {
            background-color: #FFD6E8 !important;
        }

        .btn-pastel.blue {
            background-color: #D4F1F4 !important;  /* 더 밝은 파스텔 블루 */
        }
        .btn-pastel.blue:hover {
            background-color: #C1E8ED !important;
        }

        /* 모바일 최적화 스타일 */
        #accordionContent {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease;
        }

        /* About Section Styles */
        .about-container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 30px;
        }

        .about-content {
            display: flex;
            align-items: center;
            gap: 50px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .about-image-container {
            flex: 0 0 65%;
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            height: 400px;
        }

        .about-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }

        .about-content:hover .about-img {
            transform: scale(1.05);
        }

        .about-text {
            flex: 0 0 35%;
            padding: 20px;
        }

        .about-text p {
            font-size: 16px;
            line-height: 1.8;
            color: #333;
            margin: 0;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .about-container {
                padding: 0 15px;
            }

            .about-content {
                flex-direction: column;
                padding: 20px;
            }

            .about-image-container {
                flex: none;
                width: 100%;
                height: 300px;
                margin-bottom: 20px;
            }

            .about-text {
                flex: none;
                width: 100%;
                padding: 0;
            }

            .about-text p {
                text-align: center;
            }
        }

        /* 원형 프로그레스 스타일 추가 */
        .circular-progress-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .circular-progress {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(rgba(255, 102, 51, 0.3) 0deg, transparent 0deg);
            transition: background 0.1s linear;
        }

        .templatemo-album-images {
            position: relative;
            display: inline-block;
        }

        /* 햄버거 메뉴 스타일 수정 */
        .hamburger-lines {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 24px;
            width: 30px;
            position: relative;
            gap: 6px;
        }

        .hamburger-lines span {
            display: block;
            height: 2px;
            width: 100%;
            background-color: white;
            margin: 0;
        }

        /* 로딩 상태 표시를 위한 스타일 추가 */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            color: white;
            margin-top: 10px;
            font-size: 1.2em;
        }

        /* Google Maps 반응형 스타일 */
        #map-canvas {
            width: 100% !important;
            height: 400px !important;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border: 2px solid #ddd;
        }

        /* 앨범 섹션 헤더 스타일 */
        .album-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .album-header h2 {
            margin: 0;
        }

        .sample-button {
            font-size: 14px;
            padding: 12px 20px;
            white-space: nowrap;
        }

        /* 플레이어 텍스트 활성화 스타일 */
        .templatemo-album-name,
        .templatemo-album-artist {
            transition: all 0.3s ease;
        }

        .templatemo-album-name.active,
        .templatemo-album-artist.active {
            color: #ff6633 !important;
            font-weight: bold !important;
            text-shadow: 0 0 5px rgba(255, 102, 51, 0.3);
        }

        @media (max-width: 768px) {
            #map-canvas {
                height: 300px !important;
                margin-bottom: 30px;
            }
            
            .col-lg-6.col-md-6.col-sm-6.col-xs-12 {
                margin-bottom: 20px;
            }

            /* 모바일에서 앨범 헤더 세로 배치 */
            .album-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }

            .sample-button {
                font-size: 13px;
                padding: 10px 18px;
            }
        }

        @media (max-width: 480px) {
            #map-canvas {
                height: 250px !important;
            }
        }

        /* 지도 로딩 스타일 */
        #map-canvas:empty::before {
            content: "🗺️ 지도를 로딩중...";
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #666;
            font-size: 16px;
            background: #f8f9fa;
        }
    </style>
</head>

<body>
    <div class="templatemo-header">
        <div class="templatemo-header-gradient-bg"></div>
        <div class="container">
            <h1 class="text-center text-uppercase templatemo-site-name"><span class="blue">Surround</span>io</h1>
            <nav class="hidden-xs text-center text-uppercase templatemo-nav">
                <ul class="menu-holder">
                    <li class="active"><a href="#home" style="color: #000;">ホーム</a></li>
                    <li><a href="#about" style="color: #000;">サービス</a></li>
                    <li><a href="#albums" style="color: #000;">アルバム</a></li>
                    <li><a href="#subscribe" style="color: #000;">予約申請</a></li>
                    <li><a href="#contact" style="color: #000;">お問い合わせ</a></li>
                </ul>
            </nav>
            <div class="text-right visible-xs">
                <a href="#" id="mobile_menu">
                    <div class="hamburger-lines">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="templatemo-header-image"></div>
    <div class="container">
        <section id="home" class="templatemo-section">
            <div class="row">
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                    <img src="images/home.png" alt="Banner" class="img-responsive center-block">
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                    <h2 class="text-right">High Quality</h2>
                    <h3 class="text-uppercase text-right margin-top-30">たった100,000円で</h3>
                    <h4 class="text-uppercase text-right">アルバム制作からグローバル配信まで</h4>
                    <p class="text-right margin-top-30">Surroundioは、没入型の立体音響コンテンツとAI技術を活用した先端音響ソリューションをリードする専門企業です。たった100,000円で、100万以上のデータベースに基づくAIエンジンとプロのオーディオエンジニアによる音声修復、ミキシング、マスタリングサービスを提供し、160以上のグローバルプラットフォームへの配信をサポートします。また、成長中のミュージシャンに追加特典を提供し、継続的な発展をサポートします。</p>
                    <a href="#subscribe" class="pull-right btn-pastel blue margin-top-30 text-uppercase">今すぐ予約</a>
                </div>
            </div>
        </section>
        <img src="images/border.png" alt="Border" class="templatemo-border">
        <section id="about" class="templatemo-section">
            <h2 class="text-uppercase text-center">サービス</h2>
            <div class="about-container margin-top-50">
                <div class="about-content">
                    <div class="about-image-container">
                        <img src="images/about.jpg" alt="About" class="about-img">
                    </div>
                    <div class="about-text">
                        <p>Surroundioは、世界的に有名なブランドShutterstockと共同で立ち上げた新しいオーディオプラットフォームです。100万以上のプロフェッショナルマスタリングデータに基づき、あなたの音楽により明確で豊かなサウンド表現力を提供します。音声をアップロードすると、音声修復、ミキシング、マスタリングを完了し、世界160以上の音楽プラットフォームへの配信をサポートします。音声を一度アップロードするだけで、プロフェッショナルレベルの最終効果が得られます。さらに、Surroundioは成長中のミュージシャンに露出機会、協力リソース、ブランドプロモーションサポートを提供し、音楽の夢の実現をステップバイステップでサポートします。</p>
                    </div>
                </div>
            </div>
        </section>
        <img src="images/border.png" alt="Border" class="templatemo-border">
        <section id="services" class="templatemo-section">
            <div class="row margin-top-50">
                <article class="col-lg-4 col-md-4 col-sm-4 col-xs-12 templatemo-product">
                    <img src="images/services/1.png" alt="AI Analysis" class="center-block">
                    <h3 class="text-uppercase text-center">AI精密分析</h3>
                    <p class="text-center">100万以上のマスタリングデータベースに基づく革新的なAIエンジンが、あなたの音声を深く分析・比較し、音質の弱点を智能的に識別し、プロフェッショナルレベルの音質向上と最適化処理を行います。</p>
                </article>
                <article class="col-lg-4 col-md-4 col-sm-4 col-xs-12 templatemo-product">
                    <img src="images/services/3.png" alt="Professional Engineers" class="center-block">
                    <h3 class="text-uppercase text-center">プロフェッショナルエンジニア</h3>
                    <p class="text-center">経験豊富なプロフェッショナルマスタリングエンジニアを招き、各作品の詳細な審査とサウンド調整を行います。細部の磨き上げから全体的な音質コントロールまで、すべて人工による精密な修正を行い、業界最高水準を確保します。</p>
                </article>
                <article class="col-lg-4 col-md-4 col-sm-4 col-xs-12 templatemo-product">
                    <img src="images/services/2.png" alt="Global Distribution" class="center-block">
                    <h3 class="text-uppercase text-center">ワンクリックグローバル配信</h3>
                    <p class="text-center">あなたの音楽は、Amazon Music、Spotify、テンセントミュージックなど、世界の主要プラットフォームに配信されます。Surroundioを通じて、あなたの作品は世界中のリスナーに届き、露出度を高め、真の国際化を実現します。海外配信チャネルを開拓し、時間とコストを節約し、あなたの創作により大きな影響力を与えます。</p>
                </article>
            </div>
        </section>
        <img src="images/border.png" alt="Border" class="templatemo-border">
        <section id="albums" class="templatemo-section">
            <div class="album-header">
                <h2 class="text-uppercase">アルバム例</h2>
                <a href="https://melodic-crepe-e582cd.netlify.app/" target="_blank" class="btn-pastel blue text-uppercase sample-button">🎵 もっとサンプルを聞く</a>
            </div>
            <p class="text-center" style="margin-top: 20px; font-size: 16px; color: #666; font-weight: 500;">比較音源：文字をタップすると再生／一時停止します。</p>
            <div class="row margin-top-50 templatemo-albums-container">
                <div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
                    <div class="templatemo-album-images">
                        <img src="images/albums/1.jpg" alt="Album 1" class="img-circle templatemo-album-img">
                        <img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
                        <img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
                        <audio id="audio1" src="audio\song1.mp3" preload="auto"></audio>
                        <audio id="audio2" src="audio\song2.mp3" preload="auto"></audio>
                        <div class="audio-player" id="player1" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(1)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress1"></div>
                            </div>
                        </div>
                        <div class="audio-player" id="player2" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(2)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress2"></div>
                            </div>
                        </div>
                    </div>
                    <div class="templatemo-album-description">
                        <p class="templatemo-album-name" onclick="togglePlay(1)" style="cursor: pointer;">処理前</p>
                        <p class="templatemo-album-artist" onclick="togglePlay(2)" style="cursor: pointer;">処理後</p>
                        <p class="templatemo-album-date" onclick="stopAudio(1)" style="cursor: pointer;">停止</p>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
                    <div class="templatemo-album-images">
                        <img src="images/albums/2.jpg" alt="Album 2" class="img-circle templatemo-album-img">
                        <img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
                        <img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
                        <audio id="audio3" src="audio\song3.mp3"></audio>
                        <audio id="audio4" src="audio\song4.mp3"></audio>
                        <div class="audio-player" id="player3" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(3)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress3"></div>
                            </div>
                        </div>
                        <div class="audio-player" id="player4" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(4)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress4"></div>
                            </div>
                        </div>
                    </div>
                    <div class="templatemo-album-description">
                        <p class="templatemo-album-name" onclick="togglePlay(3)" style="cursor: pointer;">処理前</p>
                        <p class="templatemo-album-artist" onclick="togglePlay(4)" style="cursor: pointer;">処理後</p>
                        <p class="templatemo-album-date" onclick="stopAudio(2)" style="cursor: pointer;">停止</p>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
                    <div class="templatemo-album-images">
                        <img src="images/albums/3.jpg" alt="Album 3" class="img-circle templatemo-album-img">
                        <img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
                        <img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
                        <audio id="audio5" src="audio\song5.mp3"></audio>
                        <audio id="audio6" src="audio\song6.mp3"></audio>
                        <div class="audio-player" id="player5" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(5)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress5"></div>
                            </div>
                        </div>
                        <div class="audio-player" id="player6" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(6)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress6"></div>
                            </div>
                        </div>
                    </div>
                    <div class="templatemo-album-description">
                        <p class="templatemo-album-name" onclick="togglePlay(5)" style="cursor: pointer;">処理前</p>
                        <p class="templatemo-album-artist" onclick="togglePlay(6)" style="cursor: pointer;">処理後</p>
                        <p class="templatemo-album-date" onclick="stopAudio(3)" style="cursor: pointer;">停止</p>
                    </div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 templatemo-album">
                    <div class="templatemo-album-images">
                        <img src="images/albums/4.jpg" alt="Album 4" class="img-circle templatemo-album-img">
                        <img src="images/album-img-bg.png" alt="Album background" class="templatemo-album-img-bg">
                        <img src="images/circle_gray.png" alt="Album frame" class="templatemo-album-img-frame">
                        <audio id="audio7" src="audio\song7.mp3"></audio>
                        <audio id="audio8" src="audio\song8.mp3"></audio>
                        <div class="audio-player" id="player7" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(7)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress7"></div>
                            </div>
                        </div>
                        <div class="audio-player" id="player8" style="display: none;">
                            <div class="play-pause-btn" onclick="togglePlay(8)">
                                <i class="fa fa-play"></i>
                            </div>
                            <div class="progress-bar">
                                <div class="progress" id="progress8"></div>
                            </div>
                        </div>
                    </div>
                    <div class="templatemo-album-description">
                        <p class="templatemo-album-name" onclick="togglePlay(7)" style="cursor: pointer;">処理前</p>
                        <p class="templatemo-album-artist" onclick="togglePlay(8)" style="cursor: pointer;">処理後</p>
                        <p class="templatemo-album-date" onclick="stopAudio(4)" style="cursor: pointer;">停止</p>
                    </div>
                </div>
            </div>
        </section>
        <img src="images/border.png" alt="Border" class="templatemo-border">
        <section id="subscribe" class="templatemo-section">
            <h2 class="text-uppercase text-center">予約申請</h2>
            <div class="upload-section margin-top-50">
                <a href="application.html" class="btn-pastel pink text-uppercase">📩 アルバム制作を申請</a>
                <a href="reservation.html" class="btn-pastel green text-uppercase" style="margin-left: 20px;">🔍 予約確認・ステータス</a>
                <a href="service-guide.html" class="btn-pastel blue text-uppercase" style="margin-left: 20px;">📋 サービス案内及びQ&A</a>
            </div>
        </section>
        <img src="images/border.png" alt="Border" class="templatemo-border">
        <section id="contact" class="templatemo-section">
            <h2 class="text-uppercase text-center">お問い合わせ</h2>
            <div class="margin-top-50">
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                    <div id="map-canvas" style="width: 100%; height: 400px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);"></div>
                </div>
                <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                    <form id="contactForm" class="tm-contact-form">
                        <div class="form-group">
                            <input type="text" id="contact_name" class="form-control" placeholder="お名前..." required />
                        </div>
                        <div class="form-group">
                            <input type="email" id="contact_email" class="form-control" placeholder="メールアドレス..." required />
                        </div>
                        <div class="form-group">
                            <input type="text" id="contact_subject" class="form-control" placeholder="件名..." required />
                        </div>
                        <div class="form-group">
                            <textarea id="contact_message" class="form-control" rows="8" placeholder="メッセージ内容..." required></textarea>
                        </div>
                        <button type="submit" class="btn text-uppercase tm-dark-bg tm-orange-text tm-send-btn btn-gradient">送信</button>
                    </form>
                </div>
            </div>
        </section>
    </div>
    <footer class="templatemo-footer margin-top-50">
        <div class="container">
            <div class="footer-flex-container">
                <p class="text-uppercase small templatemo-copyright">Surroundio copyright © 2022 Nationalux Canada, All rights reserved.</p>
            </div>
            <img src="images/go-to-top.png" alt="Go to top" class="img-responsive tm-go-to-top">
        </div>
    </footer>
    <div id="responsive-menu" class="visible-xs">
        <ul class="menu-holder">
            <li><a href="#home"><i class="fa fa-home"></i> ホーム</a></li>
            <li><a href="#about"><i class="fa fa-info-circle"></i> サービス</a></li>
            <li><a href="#albums"><i class="fa fa-music"></i> アルバム</a></li>
            <li><a href="#subscribe"><i class="fa fa-calendar"></i> 予約申請</a></li>
            <li><a href="#contact"><i class="fa fa-envelope"></i> お問い合わせ</a></li>
            <li class="menu-divider"></li>
            <li><a href="./terms-template.html?page=publish-rules"><i class="fa fa-file-text"></i> 配信規定</a></li>
            <li><a href="./terms-template.html?page=terms-of-use"><i class="fa fa-file-text"></i> 利用規約</a></li>
            <li><a href="./terms-template.html?page=copyright-management"><i class="fa fa-file-text"></i> 著作権管理サービス利用規約</a></li>
        </ul>
    </div>
    <div class="loading-overlay" id="loadingOverlay">
        <div style="text-align: center;">
            <div class="loading-spinner"></div>
            <div class="loading-text">送信中...</div>
        </div>
    </div>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script src="js/templatemo_script.js"></script>
    <script type="module" src="js/config.js"></script>
    <script type="module" src="js/api.js"></script>
    <script type="module" src="js/form-handler.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBQXWJ6QWnA3X0JNzeykUpFLJCPxFb68r0&callback=initMap" async defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        function openAccordion() {
            const content = document.getElementById('accordionContent');
            if (!content) return;  // content가 없으면 함수 종료
            
            const currentHeight = content.style.maxHeight;
            if (currentHeight && currentHeight !== '0px') {
                content.style.maxHeight = '0px';
            } else {
                content.style.maxHeight = '2000px';
            }
        }

        async function handleSubmit(event) {
            event.preventDefault();
            console.log('Form submission started');

            const form = document.getElementById('albumForm');
            const submitButton = form.querySelector('button[type="submit"]');
            const loadingOverlay = document.getElementById('loadingOverlay');
            const formData = new FormData(form);

            try {
                console.log('Form data:', {
                    name: formData.get('name'),
                    age: formData.get('age'),
                    gender: formData.get('gender'),
                    email: formData.get('email'),
                    date: formData.get('date'),
                    time: formData.get('time'),
                    mainRequest: formData.get('mainRequest'),
                    note: formData.get('note'),
                    memberKey: formData.get('memberKey'),
                    audio: formData.get('audio'),
                    image: formData.get('image')
                });

                // 로딩 상태 표시
                submitButton.disabled = true;
                loadingOverlay.style.display = 'flex';
                console.log('Loading state activated');

                // 날짜 포맷 처리
                const dateValue = $("#date").datepicker("getDate");
                if (dateValue) {
                    const year = dateValue.getFullYear();
                    const month = String(dateValue.getMonth() + 1).padStart(2, '0');
                    const day = String(dateValue.getDate()).padStart(2, '0');
                    formData.set('date', `${year}年${month}月${day}日`);
                    console.log('Date formatted:', formData.get('date'));
                }

                // 언어 설정
                formData.append('language', 'ja');

                console.log('Sending request to:', 'https://pro-audio-jp-1.onrender.com/upload');
                const response = await fetch('https://pro-audio-jp-1.onrender.com/upload', {
                    method: 'POST',
                    body: formData
                });

                console.log('Response received:', {
                    status: response.status,
                    statusText: response.statusText
                });

                const result = await response.json();
                console.log('Response data:', result);
                
                if (!response.ok) {
                    throw new Error(result.message || 'アップロードに失敗しました');
                }

                // 성공 시
                alert('アップロードが完了しました！');
                form.reset();
                document.querySelector('.file-status').textContent = '選択されたファイルはありません';
                document.querySelector('.file-select-button').textContent = 'ファイルを選択';
                
                // 아코디언 닫기
                document.getElementById('accordionContent').style.maxHeight = '0px';

            } catch (error) {
                console.error('Error details:', {
                    message: error.message,
                    stack: error.stack
                });
                alert(error.message || 'エラーが発生しました。もう一度お試しください。');
            } finally {
                // 로딩 상태 해제
                submitButton.disabled = false;
                loadingOverlay.style.display = 'none';
                console.log('Form submission completed');
            }
        }

        // 폼 제출 이벤트 리스너 등록
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM Content Loaded');
            const form = document.getElementById('albumForm');
            if (form) {
                console.log('Form found, attaching submit event listener');
                form.addEventListener('submit', handleSubmit);
            } else {
                console.error('Form not found!');
            }
        });

        // Contact Form Submission
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const formData = {
                name: document.getElementById('contact_name').value,
                email: document.getElementById('contact_email').value,
                subject: document.getElementById('contact_subject').value,
                message: document.getElementById('contact_message').value
            };

            // EmailJS 초기화
            (function() {
                emailjs.init("jfle4pXv1E8FEPCJv");
            })();

            // 이메일 전송
            emailjs.send(
                "service_jsn3q06",
                "template_ha65rt7",
                {
                    to_email: "kmat0@naver.com",
                    from_name: formData.name,
                    from_email: formData.email,
                    subject: formData.subject,
                    message: formData.message,
                    language: 'zh' // 언어 식별자 추가
                }
            ).then(
                function(response) {
                    alert("消息发送成功！");
                    document.getElementById('contactForm').reset();
                },
                function(error) {
                    console.error("发送失败:", error);
                    alert("消息发送失败，请重试。");
                }
            );
        });

        // Audio Player Functionality
        let currentlyPlaying = null;
        let currentPlayer = null;
        let lastPlaybackTime = {};
        const players = {};

        // 모바일 기기 감지 함수
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }

        // 페이지 로드 시 모바일이면 오디오 소스 변경
        document.addEventListener('DOMContentLoaded', function() {
            if (isMobileDevice()) {
                for (let i = 1; i <= 8; i++) {
                    const audio = document.getElementById(`audio${i}`);
                    if (audio) {
                        audio.src = `audio/mobile/song${i}.mp3`;
                    }
                }
            }
        });

        function updateCircularProgress(audio, albumImage) {
            if (!audio.duration) return;
            const progress = (audio.currentTime / audio.duration) * 360;
            const circularProgress = albumImage.querySelector('.circular-progress');
            if (circularProgress) {
                circularProgress.style.background = `conic-gradient(rgba(255, 102, 51, 0.3) ${progress}deg, transparent ${progress}deg)`;
            }
        }

        function stopAudio(albumId) {
            // Each album has two tracks, so we need to stop both
            const trackIds = [albumId * 2 - 1, albumId * 2];
            
            trackIds.forEach(trackId => {
                const audio = document.getElementById(`audio${trackId}`);
                const player = document.getElementById(`player${trackId}`);
                
                if (audio) {
                    // Stop and reset the audio
                    audio.pause();
                    audio.currentTime = 0;
                    
                    // Reset the player UI
                    if (player) {
                        const playIcon = player.querySelector('.play-pause-btn i');
                        const progress = player.querySelector('.progress');
                        if (playIcon) playIcon.className = 'fa fa-play';
                        if (progress) progress.style.width = '0%';
                        player.style.display = 'none';
                    }
                    
                    // Reset the circular progress
                    const albumImage = player.closest('.templatemo-album-images');
                    if (albumImage) {
                        const circularProgress = albumImage.querySelector('.circular-progress');
                        if (circularProgress) {
                            circularProgress.style.background = 'conic-gradient(rgba(255, 102, 51, 0.3) 0deg, transparent 0deg)';
                        }

                        // 텍스트 비활성화
                        const albumContainer = albumImage.closest('.templatemo-album');
                        const beforeText = albumContainer.querySelector('.templatemo-album-name');
                        const afterText = albumContainer.querySelector('.templatemo-album-artist');
                        if (beforeText) beforeText.classList.remove('active');
                        if (afterText) afterText.classList.remove('active');
                    }

                    // Reset stored playback time for this track
                    if (lastPlaybackTime[audio.id]) {
                        delete lastPlaybackTime[audio.id];
                    }

                    // Reset current playing states if this was the playing track
                    if (currentlyPlaying === audio) {
                        currentlyPlaying = null;
                        currentPlayer = null;
                    }
                }
            });
        }

        function togglePlay(id) {
            const audio = document.getElementById(`audio${id}`);
            const player = document.getElementById(`player${id}`);
            const albumImage = player.closest('.templatemo-album-images');
            const playBtn = player.querySelector('.play-pause-btn');
            const playIcon = playBtn.querySelector('i');
            const progress = document.getElementById(`progress${id}`);

            // 현재 앨범의 before/after 텍스트 요소 찾기
            const albumContainer = albumImage.closest('.templatemo-album');
            const beforeText = albumContainer.querySelector('.templatemo-album-name');
            const afterText = albumContainer.querySelector('.templatemo-album-artist');

            // Add circular progress container if not exists
            if (!albumImage.querySelector('.circular-progress-container')) {
                const container = document.createElement('div');
                container.className = 'circular-progress-container';
                const circularProgress = document.createElement('div');
                circularProgress.className = 'circular-progress';
                container.appendChild(circularProgress);
                albumImage.appendChild(container);
            }

            if (currentlyPlaying && currentlyPlaying !== audio) {
                lastPlaybackTime[currentlyPlaying.id] = currentlyPlaying.currentTime;
                currentlyPlaying.pause();
                const oldPlayer = currentPlayer;
                const oldPlayIcon = oldPlayer.querySelector('.play-pause-btn i');
                oldPlayIcon.className = 'fa fa-play';
                oldPlayer.style.display = 'none';
                
                const oldAlbumImage = oldPlayer.closest('.templatemo-album-images');
                const oldCircularProgress = oldAlbumImage.querySelector('.circular-progress');
                if (oldCircularProgress) {
                    oldCircularProgress.style.background = 'conic-gradient(rgba(255, 102, 51, 0.3) 0deg, transparent 0deg)';
                }

                // 이전 재생 중인 앨범의 텍스트 비활성화
                const oldAlbumContainer = oldAlbumImage.closest('.templatemo-album');
                const oldBeforeText = oldAlbumContainer.querySelector('.templatemo-album-name');
                const oldAfterText = oldAlbumContainer.querySelector('.templatemo-album-artist');
                if (oldBeforeText) oldBeforeText.classList.remove('active');
                if (oldAfterText) oldAfterText.classList.remove('active');

                if (lastPlaybackTime[audio.id]) {
                    audio.currentTime = lastPlaybackTime[audio.id];
                }
            }

            if (audio.paused) {
                if (lastPlaybackTime[audio.id]) {
                    audio.currentTime = lastPlaybackTime[audio.id];
                }
                
                audio.play();
                playIcon.className = 'fa fa-pause';
                currentlyPlaying = audio;
                currentPlayer = player;
                updateCircularProgress(audio, albumImage);

                // 현재 재생 중인 트랙에 따라 텍스트 활성화
                // 홀수 ID는 before (처리전), 짝수 ID는 after (처리후)
                if (beforeText) beforeText.classList.remove('active');
                if (afterText) afterText.classList.remove('active');
                
                if (id % 2 === 1) {
                    // before (처리전) 재생
                    if (beforeText) beforeText.classList.add('active');
                } else {
                    // after (처리후) 재생
                    if (afterText) afterText.classList.add('active');
                }
            } else {
                audio.pause();
                lastPlaybackTime[audio.id] = audio.currentTime;
                playIcon.className = 'fa fa-play';
                const circularProgress = albumImage.querySelector('.circular-progress');
                if (circularProgress) {
                    circularProgress.style.background = 'conic-gradient(rgba(255, 102, 51, 0.3) 0deg, transparent 0deg)';
                }
                currentlyPlaying = null;
                currentPlayer = null;

                // 일시정지 시 텍스트 비활성화
                if (beforeText) beforeText.classList.remove('active');
                if (afterText) afterText.classList.remove('active');
            }

            if (!players[id]) {
                players[id] = true;
                audio.addEventListener('timeupdate', () => {
                    const progressPercent = (audio.currentTime / audio.duration) * 100;
                    progress.style.width = `${progressPercent}%`;
                    updateCircularProgress(audio, albumImage);
                });

                audio.addEventListener('ended', () => {
                    playIcon.className = 'fa fa-play';
                    progress.style.width = '0%';
                    const circularProgress = albumImage.querySelector('.circular-progress');
                    if (circularProgress) {
                        circularProgress.style.background = 'conic-gradient(rgba(255, 102, 51, 0.3) 0deg, transparent 0deg)';
                    }
                    currentlyPlaying = null;
                    currentPlayer = null;
                    lastPlaybackTime[audio.id] = 0;

                    // 재생 종료 시 텍스트 비활성화
                    if (beforeText) beforeText.classList.remove('active');
                    if (afterText) afterText.classList.remove('active');
                });
            }
        }

        // カレンダー関連テキスト変更
        const dateInput = document.getElementById('date');
        if (dateInput) {
            dateInput.addEventListener('focus', function() {
                // カレンダーの曜日名を日本語に変更
                const weekdayLabels = document.querySelectorAll('.ui-datepicker-calendar th');
                if (weekdayLabels.length) {
                    const weekdays = ['日', '月', '火', '水', '木', '金', '土'];
                    weekdayLabels.forEach((label, index) => {
                        label.textContent = weekdays[index];
                    });
                }
            });
        }

        $(document).ready(function() {
            if ($.datepicker) {
                // カレンダー設定
                $.datepicker.setDefaults({
                    dateFormat: 'yy年mm月dd日',
                    monthNames: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
                    monthNamesShort: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
                    dayNames: ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'],
                    dayNamesShort: ['周日', '周一', '周二', '周三', '周四', '周五', '周六'],
                    dayNamesMin: ['日', '一', '二', '三', '四', '五', '六'],
                    showMonthAfterYear: true,
                    yearSuffix: '年',
                    changeMonth: true,
                    changeYear: true,
                    beforeShow: function(input, inst) {
                        inst.dpDiv.addClass('custom-datepicker');
                    }
                });

                $("#date").datepicker();
            }

            // 時間入力設定
            const timeInput = document.getElementById('time');
            if (timeInput) {
                $(timeInput).on('input', function(e) {
                    let value = e.target.value.replace(/\D/g, '');

                    // 時間、分、秒制限
                    if (value.length >= 2) {
                        let hours = value.substring(0, 2);
                        if (parseInt(hours) > 23) hours = '23';
                        value = hours + value.substring(2);
                    }
                    if (value.length >= 4) {
                        let minutes = value.substring(2, 4);
                        if (parseInt(minutes) > 59) minutes = '59';
                        value = value.substring(0, 2) + minutes + value.substring(4);
                    }
                    if (value.length >= 6) {
                        let seconds = value.substring(4, 6);
                        if (parseInt(seconds) > 59) seconds = '59';
                        value = value.substring(0, 4) + seconds;
                    }

                    // 形式指定 (HH:mm:ss)
                    let formatted = '';
                    if (value.length > 0) formatted = value.substring(0, 2);
                    if (value.length > 2) formatted += ':' + value.substring(2, 4);
                    if (value.length > 4) formatted += ':' + value.substring(4, 6);

                    e.target.value = formatted;

                    // 日本語形式表示
                    if (value.length === 6) {
                        const [h, m, s] = [value.substring(0, 2), value.substring(2, 4), value.substring(4, 6)];
                        document.querySelector('.time-display').textContent = `${h}時${m}分${s}秒`;
                    } else {
                        document.querySelector('.time-display').textContent = '時間を入力してください (24時間制)';
                    }
                });

                // フォーカスが外れると完全な形式チェック
                $(timeInput).on('blur', function(e) {
                    const value = e.target.value.replace(/\D/g, '');
                    if (value.length > 0 && value.length < 6) {
                        let padded = value.padEnd(6, '0');
                        let formatted = padded.substring(0, 2) + ':' +
                            padded.substring(2, 4) + ':' +
                            padded.substring(4, 6);
                        e.target.value = formatted;

                        const [h, m, s] = [padded.substring(0, 2), padded.substring(2, 4), padded.substring(4, 6)];
                        document.querySelector('.time-display').textContent = `${h}時${m}分${s}秒`;
                    }
                });
            }

            // ファイル選択イベント
            const fileInput = document.getElementById('audio');
            if (fileInput) {
                fileInput.addEventListener('change', function(e) {
                    const fileName = e.target.files[0]?.name;
                    const statusElement = document.querySelector('.file-status');
                    statusElement.textContent = fileName || '選択されたファイルはありません';

                    // ファイルが選択されるとボタンテキスト変更
                    const buttonElement = document.querySelector('.file-select-button');
                    buttonElement.textContent = fileName ? 'ファイルを変更' : 'ファイルを選択';
                });
            }

            // 모바일 메뉴 토글
            $('#mobile_menu').on('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                $('#responsive-menu').show().animate({right: 0});
            });

            // 메뉴 항목 클릭시 메뉴 닫기
            $('#responsive-menu a').on('click', function() {
                $('#responsive-menu').animate({right: -1500}, function() {
                    $(this).hide();
                });
            });

            // 메뉴 외부 클릭시 닫기
            $('body').on('click', function(e) {
                if (!$(e.target).closest('#mobile_menu').length && !$(e.target).closest('#responsive-menu').length) {
                    if ($('#responsive-menu').is(':visible')) {
                        $('#responsive-menu').animate({right: -1500}, function() {
                            $(this).hide();
                        });
                    }
                }
            });

            // 창 크기 변경시 처리
            $(window).on('load resize', function() {
                if ($(window).width() > 768) {
                    $('#responsive-menu').css({right: -1500}).hide();
                }
            });
        });

        // Google Maps initialization
        function initMap() {
            try {
                const location = { lat: 35.6762, lng: 139.6503 }; // Tokyo, Japan
                const mapStyles = [
                    {
                        "featureType": "all",
                        "elementType": "geometry",
                        "stylers": [{"saturation": -100}, {"lightness": 50}]
                    },
                    {
                        "featureType": "road",
                        "elementType": "geometry",
                        "stylers": [{"lightness": 100}]
                    }
                ];

                const mapOptions = {
                    center: location,
                    zoom: 14,
                    styles: mapStyles,
                    disableDefaultUI: false,
                    zoomControl: true,
                    mapTypeControl: true,
                    streetViewControl: true,
                    fullscreenControl: true
                };

                const mapElement = document.getElementById('map-canvas');
                if (!mapElement) {
                    console.error('Map canvas element not found');
                    return;
                }

                const map = new google.maps.Map(mapElement, mapOptions);
                const marker = new google.maps.Marker({
                    position: location,
                    map: map,
                    animation: google.maps.Animation.DROP,
                    title: 'Surroundio - 東京オフィス'
                });

                const contentString = 
                    '<div style="padding: 20px; max-width: 280px; font-family: Arial, sans-serif;">' +
                    '<h4 style="margin: 0 0 15px; color: #333; font-size: 18px;">🎵 Surroundio</h4>' +
                    '<p style="margin: 0 0 10px; color: #666; line-height: 1.4;">プロフェッショナルオーディオ処理と配信サービス</p>' +
                    '<p style="margin: 0 0 10px; color: #666; font-size: 14px;">📍 東京都中央区</p>' +
                    '<p style="margin: 0; color: #666; font-size: 14px;">📞 お問い合わせ: kmat0@naver.com</p>' +
                    '</div>';

                const infowindow = new google.maps.InfoWindow({
                    content: contentString
                });

                marker.addListener('click', () => {
                    infowindow.open(map, marker);
                });

                // 페이지 로드 시 정보창 자동 열기
                setTimeout(() => {
                    infowindow.open(map, marker);
                }, 1000);

                console.log('Google Maps initialized successfully');
            } catch (error) {
                console.error('Error initializing Google Maps:', error);
                // 지도 로드 실패 시 대체 메시지 표시
                const mapElement = document.getElementById('map-canvas');
                if (mapElement) {
                    mapElement.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 100%; background: #f8f9fa; color: #666; font-size: 16px;">🗺️ 지도를 로딩중입니다...</div>';
                }
            }
        }

        // 다양한 방법으로 지도 초기화 시도
        function initializeMap() {
            if (typeof google !== 'undefined' && google.maps) {
                initMap();
            } else {
                console.log('Google Maps API not loaded yet, retrying...');
                setTimeout(initializeMap, 500);
            }
        }

        // 페이지 로드 시 지도 초기화
        document.addEventListener('DOMContentLoaded', function() {
            initializeMap();
        });

        // 윈도우 로드 시에도 시도
        window.addEventListener('load', function() {
            initializeMap();
        });

        // Google Maps API 콜백으로도 설정
        window.initMap = initMap;
    </script>
</body>

</html>